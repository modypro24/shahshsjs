// insultCommand.js

const insultListFshkh = ["ي الي طوب الارض نايكك",
                          "ي كلب يابن الـ كلب انت",
                          "ي عرصجي",
                          "ي عبيط",
                          "ي كوس",
                          "يلا نت جديد احاا😂",
                          "انت جديد يالا صح",
                          "ي مسخره",
                          "ي كلب المجال",
                          "ي اريال",
                          "ي ديوث",
                          "ي مفشوخ",
                          "يسطا نت ملكش ف المجال",
                          "انت عبيط خالص",
                          "اعترف اني نيكك",
                          "وربي لهين كسمك",
                          "ي مجلد ي شحات",
                          "هخخ ميت وعرص وكلبجي",
                          "ي ميت ي شرموط ي كس",
                          "ولا ي اهطل نت",
                          "كسم الضحك😂😂",
                          "رد عليا ياض",
                          "ي لحاس",
                          "تع مص زبري",
                          "امك صحبتي وابوك عارف",
                          "اصلو ايريال ايوه",
                          "يالا ي الي امك شرموطه زيك",
                          "انت يالا ي ديوث ي معرصاتي",
                          "اامك شرموطه كبيره",
                          "امك مشفتش دلع غير مني",
                          "كسمك ياهطل رد",
                          "رد عليا ياض",
                          "يالا ي معرص انت ي كوس",
                          "يبني تع مص زبري زي امك",
                          "انت ي طيز",
                          "ي عويل",
                          "امك كانت معايا امبارح ايوه",
                          "كنت زنقها زنقة الكلاب",
                          "كانت بتصوت ايوه",
                          "اجري يعرص اجري",
                          "ييني بطل هطل احاا اي د😂",
                          "انت يلا لسا جديد صح",
                          "انت ابن شرموطه ي جاهل ي خول",
                          "ي معرص ي خول ي كلبجي ي ميت",
                          "يابن العاهره",
                          "ييالي امك رقاصه",
                          "كانت بترقصلي ايوه",
                          "وجبت صحابي وعملنا حفله عليها",
                          "عيطت جامد ايوه",
                          "انت مكروف من كلو يالا ي عرص",
                          "ي شاذ ي ديوث",
                          "ي كسمك ي اهطل ي عره",
                          "ي عبيط يعرص ي متناك",
                          "انت داخل المجال م امتي",
                          "انت محدش يعرفك يبني",
                          "انت جديد يالا صح ي مسخره",
                          "يابني انا صاحب اللعبة دي",
                          "انا الي عملت المجال ده يالا",
                          "عشان انيك فيك انت و الـ زيك كدا",
                          "يلا ي ديوث ي عرص سد",
                          "هشردك بس اتقل",
                          "انتا يسطا تعبان فشخ",
                          "مين الي دخلك المجال ي اهطل",
                          "يبني تعا مص زبري تعا",
                          "تعا ي مخلط م كلاب السكك تعالي",
                          "افهم بقا نتا تعبان خالص ي عرص ي خول",
                          "انت فين ي بني تعالا مص زبيي ميت ي عرص احاا فينك",
                          "يخي كسم الضحك ي اهطل ي عرص"];
const insultListKhtm = ["كسمك لاجل سما",
                         "كسمك لاجل اي حد ف المجال",
                         "كسمك لاجل اني تقيل عليك",
                         "كسمك لاجل اني هختم كسمك",
                         "كسمك لاجل طيزك",
                         "كسمك لاجل اي حد ماشي ف الشارع",
                         "كسمك لاجل انك عبيط",
                         "كسمك لاجل الي دخلك المجال",
                         "كسمك لاجل اني نايك كسمك",
                         "كسمك لاجل الشجر",
                         "كسمك لاجل التراب",
                         "كسمك لاجل امك",
                         "كسمك لاجل انك خدام",
                         "كسمك لاجل امك الشرموطه الي بنيكها",
                         "كسمك لاجل انك عرص",
                         "كسمك لاجل اني بختم فيك",
                         "كسمك لاجل انك خول",
                         "كسمك لاجل اي واحده ف المجال",
                         "كسمك لاجل السمك",
                         "كسمك لاجل اني نايكك ي عره",
                         "كسمك لاجل انك هلفوت",
                         "كسمك لاجل انك عبيط",
                         "كسمك لاجل انك ديوث",
                         "كسمك لاجل انك بتتناك",
                         "كسمك لاجل ابوك الاريال",
                         "كسمك لاجل اي حد",
                         "كسمك لاجل انك طري",
                         "كسمك لاجل اخواتي",
                         "كسمك لاجل انك اكبر شرموط ف البلد",
                         "كسمك لاجل انك م عارف ترد",
                         "كسمك لاجل انك عار",
                         "كسمك لاجل انك هتهرب ببلوك",
                         "كسمك لاجل كلامك الاهطل",
                         "كسمك لاجل النثاء",
                         "كسمك لاجل الاطفال",
                         "ونقول طب هروب العرص بنجاح",
                         "من زبر عمه",
                         "وختم الاهطل",
                         "ونقول تاني تم نيككك",
                         "ع ايد عمك ي عرص",
                         "**النهايه الفاجره ي كسمك**",
                         "خخخخخخخخخخخخخخخخخخخخخخخخخخخ"];

export const handleInsultCommand = async (sock, m, args, from, cmd) => {
  const mention = m.message.extendedTextMessage?.contextInfo?.mentionedJid?.[0];
  if (!mention) {
    return sock.sendMessage(from, { text: '❗ منشن الشخص أولاً.' }, { quoted: m });
  }

  const intro = cmd === '.فشخ1'
    ? '⚠️ هيا بنا نفشخ خصمك – استعد للقصف!'
    : '⚠️ هيا بنا نختم خصمك – دور القاضية!';

  try {
    await sock.sendMessage(from, { text: intro, mentions: [mention] }, { quoted: m });
  } catch (e) {
    console.error('❌ فشل في إرسال رسالة المقدمة:', e.message);
  }

  const list = cmd === '.فشخ1' ? insultListFshkh : insultListKhtm;
  const batchSize = 2; // رسالتين في كل دفعة
  const pauseBetween = 3500; // 2.5 ثانية تأخير بين كل دفعة
  const tag = `@${mention.split('@')[0]}`;

  for (let i = 0; i < list.length; i += batchSize) {
    const batch = list
      .slice(i, i + batchSize)
      .map(line => `${tag} ${line}`)
      .join('\n');

    try {
      await sock.sendMessage(from, {
        text: batch,
        mentions: [mention]
      });
    } catch (err) {
      console.error('❌ حصل خطأ أثناء إرسال دفعة الشتائم:', err.message);
    }

    if (i + batchSize < list.length) {
      await new Promise(res => setTimeout(res, pauseBetween));
    }
  }
};
